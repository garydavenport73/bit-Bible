<script>
    let allOutput = "STARTSTARTSTARTNEWLINE";
    let filename = "";

    function showInfo() {
        allElements = document.getElementsByTagName("*");
        for (let i = 0; i < allElements.length; i++) {
            if (allElements[i].id === "topheading") {
                allOutput += "BOOKANDCHAPTER" + allElements[i].innerText + "BOOKANDCHAPTERNEWLINE";
                filename = allElements[i].innerText.replaceAll(" ", "").replaceAll("◄", "").replaceAll("►", "");
                //console.log("bookandchapter"+allElements[i].innerText+"bookandchapter");
            }
            if (allElements[i].className === "hdg") {
                allOutput += "HEADING" + allElements[i].innerText + "HEADINGNEWLINE";

            }
            if (allElements[i].className === "reg") {
                allOutput += "PARAGRAPHSTARTSNEWLINE";

            }
            if (allElements[i].className === "reftext") {
                allOutput += "VERSENUMBER" + allElements[i].innerText + "VERSENUMBERNEWLINE";

            }
        }
        allOutput = allOutput.replaceAll("\n", "").replaceAll("NEWLINE", "\n");
        allOutput += "ENDENDEND\n";
        console.log(allOutput);

        pathArray = window.location.pathname.split("/");
        filename = pathArray[pathArray.length - 1];
        filename = filename.replace(".all.html", ".txt");
        //alert(filename);
        saveStringToTextFile(allOutput, filename);
    }

    function saveStringToTextFile(str1, filename) {
        let saveFileName = filename;
        let blobOfText = new Blob([str1], {
            type: "text/plain"
        });
        let urlToTextBlob = window.URL.createObjectURL(blobOfText);
        let downloadLink = document.createElement("a");
        downloadLink.style.display = "none";
        downloadLink.download = saveFileName;
        downloadLink.href = urlToTextBlob;
        document.body.appendChild(downloadLink);
        downloadLink.click();
        downloadLink.parentElement.removeChild(downloadLink);
    }
    showInfo();
</script>